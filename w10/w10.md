# JavaScript Debugging Exercise: Carbon Footprint Calculator (Expanded)

### Instructions for Students

For each scenario below, open the Chrome DevTools (**right-click -> Inspect**) and go to the **Sources** tab. Find the specified JavaScript file, locate the line number, and click on the line number to set a **breakpoint**. Then, perform the action described (e.g., "submit the form") to pause the code. Use the **Scope** panel on the right to inspect variables and answer the question.

---

### Group 1: Form Submission and Data Flow

1.  **The Initial Event**
    * **File**: `app.js`, **Function**: `handleFormSubmit`, **Line**: `61` (`event.preventDefault();`)
    * **Action**: Fill out the form and click "Calculate Footprint".
    * **‚ùì Question**: Look at the `event` object. What was the `type` of event and what `target` element did it come from?
    * **üí° Concept**: Event listeners and the event object.

2.  **Getting Form Data**
    * **File**: `form-handler.js`, **Function**: `getFormInputs`, **Line**: `110` (`return { ... };`)
    * **Action**: Resume from #1.
    * **‚ùì Question**: What are the data types of `householdMembersInput.value` and `isApartmentInput.checked`? How do they compare to the values in the returned object after `parseInt()`?
    * **üí° Concept**: Reading input values and type coercion (`String` to `Number`).

3.  **Processing Radio Buttons**
    * **File**: `form-handler.js`, **Function**: `getSelectedRadioValue`, **Line**: `52` (`if (radio.checked) {`)
    * **Action**: Submit the form. The code will pause multiple times.
    * **‚ùì Question**: Step over a few times. For "dietType", what is the `value` of the `radio` element when `radio.checked` is finally `true`?
    * **üí° Concept**: Looping through a `NodeList` and checking element properties.

4.  **Clearing the Form**
    * **File**: `form-handler.js`, **Function**: `clearForm`, **Line**: `133` (`carbonFootprintForm.reset();`)
    * **Action**: Fill out the form, then click the "Clear Form" button.
    * **‚ùì Question**: The native `.reset()` method is called on the form. Step over this line and observe the page. Did it reset all the text, number, and checkbox inputs?
    * **üí° Concept**: Using native HTML element methods (`.reset()`) to efficiently manage form state.

5.  **Dynamic Button Text**
    * **File**: `form-handler.js`, **Function**: `populateFormForEdit`, **Line**: `87` (`submitButton.textContent = 'Update Entry';`)
    * **Action**: Click "Edit" on any existing entry in the table.
    * **‚ùì Question**: Before this line runs, inspect the `submitButton` in the Scope panel. What is its `textContent`? Step over this line and check again.
    * **üí° Concept**: DOM Manipulation: Programmatically changing the text content of an element.

---

### Group 2: The Calculation Pipeline

6.  **Passing Arguments to Functions**
    * **File**: `calculator.js`, **Function**: `calculateFootprint`, **Line**: `127` (`const householdPoints = ...;`)
    * **Action**: Submit the form.
    * **‚ùì Question**: The parameter here is `data`. What was the variable name passed as an *argument* from `app.js`? Do they need to match?
    * **üí° Concept**: The difference between function **arguments** and **parameters**.

7.  **Conditional Logic in Calculations**
    * **File**: `calculator.js`, **Function**: `calculateHouseholdPoints`, **Line**: `4` (`if (householdMembers === 1) return 14;`)
    * **Action**: Enter `3` for household members and submit.
    * **‚ùì Question**: Step through the code. Which `if`/`else if` condition evaluates to `true`, and what value is returned?
    * **üí° Concept**: How `if`/`else if` statements create mutually exclusive code paths.

8.  **The Final Calculated Object**
    * **File**: `app.js`, **Function**: `handleFormSubmit`, **Line**: `65` (`const entryToSave = { ... };`)
    * **Action**: Submit the form.
    * **‚ùì Question**: Inspect the `calculatedResults` object. What are its properties and the value of `totalFootprint`?
    * **üí° Concept**: Returning objects from functions to pass multiple pieces of data.

9.  **Using a `switch` Statement**
    * **File**: `calculator.js`, **Function**: `calculateFoodDietPoints`, **Line**: `28` (`switch (dietType) {`)
    * **Action**: Select "Vegetarian" for diet type and submit the form.
    * **‚ùì Question**: What is the value of the `dietType` variable? Step through the code. Which `case` provides the match, and what happens when the code reaches the `return` statement?
    * **üí° Concept**: Using a `switch` statement as a structured alternative to a long `if/else if` chain.

10. **Boolean Logic in Conditionals**
    * **File**: `calculator.js`, **Function**: `calculateWaterConsumptionsPoints`, **Line**: `63` (`if(hasDishwasher && hasWashingMachine) {`)
    * **Action**: Check both "I have a dishwasher" AND "I have a washing machine", set runs to 5, and submit.
    * **‚ùì Question**: What are the boolean values for `hasDishwasher` and `hasWashingMachine`? Why does the code enter this specific `if` block?
    * **üí° Concept**: Evaluating conditions with the logical AND (`&&`) operator.

---

### Group 3: Managing Data with Arrays and Objects

11. **Creating a New Entry**
    * **File**: `app.js`, **Function**: `handleFormSubmit`, **Line**: `92` (`carbonFootprintEntries.push(entryToSave);`)
    * **Action**: Submit a new form entry.
    * **‚ùì Question**: Inspect `entryToSave`. Does it have an `id` and `timestamp` yet?
    * **üí° Concept**: Using the spread syntax (`...`) to combine objects.

12. **Adding to the Main Array**
    * **File**: `app.js`, **Function**: `handleFormSubmit`, **Line**: `96` (`storage.saveEntries(carbonFootprintEntries);`)
    * **Action**: Submit the form.
    * **‚ùì Question**: Inspect `carbonFootprintEntries`. How many items does it contain now? Is the last item the one you just submitted?
    * **üí° Concept**: Using the `push()` method to add an element to the end of an array.

13. **Finding an Entry to Update**
    * **File**: `app.js`, **Function**: `handleFormSubmit`, **Line**: `74` (`const index = carbonFootprintEntries.findIndex(...)`)
    * **Action**: Edit an entry, change a value, and click "Update Entry".
    * **‚ùì Question**: What is the value of `formData.id`? What is the purpose of the `findIndex` method here?
    * **üí° Concept**: Using array methods (`findIndex`) to locate objects based on a property.

14. **Updating an Object in the Array**
    * **File**: `app.js`, **Function**: `handleFormSubmit`, **Line**: `79` (`carbonFootprintEntries[index] = entryToSave;`)
    * **Action**: Continue from #13.
    * **‚ùì Question**: Before this line runs, note the original entry at the found `index`. Step over this line. Has the object at that index been replaced?
    * **üí° Concept**: Updating an array element by its index.

15. **Populating the Array on Load**
    * **File**: `app.js`, **Function**: `init`, **Line**: `230` (`carbonFootprintEntries.push(...loadedEntries);`)
    * **Action**: Ensure you have saved data, then refresh the page.
    * **‚ùì Question**: Before this line, what is the `length` of `carbonFootprintEntries`? What is the `length` of `loadedEntries`? Step over this line and check the length of `carbonFootprintEntries` again.
    * **üí° Concept**: Using the spread syntax (`...`) to efficiently add all items from one array into another.

16. **Clearing the In-Memory Array**
    * **File**: `app.js`, **Function**: `performClearAllData`, **Line**: `133` (`carbonFootprintEntries.length = 0;`)
    * **Action**: Add entries, then click "Clear All Saved Data" twice.
    * **‚ùì Question**: Inspect `carbonFootprintEntries` before this line. Step over it. What is its length now? Why is this method used instead of `carbonFootprintEntries = []`?
    * **üí° Concept**: Modifying a `const` array by changing its properties (like `length`) rather than reassigning it.

---

### Group 4: Local Storage and Data Persistence

17. **Preparing Data for Storage**
    * **File**: `storage.js`, **Function**: `saveEntries`, **Line**: `7` (`localStorage.setItem(...)`)
    * **Action**: Submit a new entry.
    * **‚ùì Question**: The `entries` parameter is a JavaScript array. What does `JSON.stringify(entries)` do to it before saving?
    * **üí° Concept**: `JSON.stringify()` converts JavaScript objects into a string for storage.

18. **Retrieving Data from Storage**
    * **File**: `storage.js`, **Function**: `loadEntries`, **Line**: `24` (`return JSON.parse(dataString);`)
    * **Action**: Refresh the page with saved data.
    * **‚ùì Question**: What is the data type of `dataString`? Step over this line. What is the data type of the returned value?
    * **üí° Concept**: `JSON.parse()` converts a JSON string back into a JavaScript object/array.

19. **Handling Storage Errors**
    * **File**: `storage.js`, **Function**: `loadEntries`, **Line**: `27` (`console.error(...)`)
    * **Action**: In DevTools > Application > Local Storage, manually corrupt the stored data (e.g., add a stray comma). Refresh the page.
    * **‚ùì Question**: The code pauses in the `catch` block. What is the error message in the `e` variable? Why is this block important?
    * **üí° Concept**: Robustness and error handling with `try...catch` blocks.

20. **Clearing Specific Storage Data**
    * **File**: `storage.js`, **Function**: `clearAllEntries`, **Line**: `35` (`localStorage.removeItem(LOCAL_STORAGE_KEY);`)
    * **Action**: Click "Clear All Saved Data" twice.
    * **‚ùì Question**: Before this line runs, view the key in the Application tab. Step over this line. Is the key still there?
    * **üí° Concept**: Removing a specific key-value pair from `localStorage`.

---

### Group 5: Rendering the UI

21. **Starting the Table Render**
    * **File**: `table-renderer.js`, **Function**: `renderTable`, **Line**: `216` (`const sortedEntries = ...`)
    * **Action**: Submit a form or refresh with existing data.
    * **‚ùì Question**: How many items are in the `entries` array passed to this function?
    * **üí° Concept**: Passing an application's dataset to a dedicated rendering module.

22. **Looping to Build Rows**
    * **File**: `table-renderer.js`, **Function**: `renderTable`, **Line**: `222` (`const rowElement = createTableRow(entry);`)
    * **Action**: Continue from #21.
    * **‚ùì Question**: Inspect the `entry` object. Step *into* the `createTableRow` function. How is the `entry` data used to build the HTML string?
    * **üí° Concept**: Iterating over an array to generate dynamic HTML.

23. **Displaying Calculated Results**
    * **File**: `results-display.js`, **Function**: `displayResults`, **Line**: `19` (`totalFootprintDisplay.textContent = ...;`)
    * **Action**: Submit a new entry.
    * **‚ùì Question**: At this point, has the "Current Entry's Footprint" section on the page become visible yet? Why or why not? (Hint: check line 26).
    * **üí° Concept**: Manipulating both content (`textContent`) and visibility (`style.display`).

24. **Data Sorting Logic**
    * **File**: `table-renderer.js`, **Function**: `renderTable` (inside `.sort()`), **Line**: `217` (`return new Date(b.timestamp) - new Date(a.timestamp)`)
    * **Action**: Have at least two entries, then add a third.
    * **‚ùì Question**: The code will pause multiple times. Inspect `a.timestamp` and `b.timestamp`. Is the return value positive or negative? How does this determine the sort order?
    * **üí° Concept**: The compare function logic for `Array.prototype.sort()`.

25. **Formatting Data for Display**
    * **File**: `table-renderer.js`, **Function**: `createTableRow`, **Line**: `178` (`<td>${formatDateForDisplay(entry.timestamp)}</td>`)
    * **Action**: Add an entry.
    * **‚ùì Question**: Step *into* the `formatDateForDisplay` function. What is the raw `entry.timestamp` string, and what does `toLocaleDateString` transform it into?
    * **üí° Concept**: Using helper functions to format raw data for a user-friendly display.

---

### Group 6: Editing and Deleting

26. **Starting the Edit Process**
    * **File**: `app.js`, **Function**: `handleEditEntry`, **Line**: `210` (`const entryToEdit = ...`)
    * **Action**: Click an entry's "Edit" button.
    * **‚ùì Question**: What is the value of the `id` parameter? How did the code know which `id` to send?
    * **üí° Concept**: Using HTML data attributes (`data-id`) to link elements to data.

27. **Populating the Form**
    * **File**: `form-handler.js`, **Function**: `populateFormForEdit`, **Line**: `76` (`householdMembersInput.value = ...;`)
    * **Action**: Continue from #26.
    * **‚ùì Question**: Inspect the `entry` object. Step over the next few lines. Are the values from `entry` correctly appearing in the form fields?
    * **üí° Concept**: Programmatically setting the `value` and `checked` properties of form inputs.

28. **Starting the Delete Process**
    * **File**: `app.js`, **Function**: `handleDeleteEntry`, **Line**: `175` (`const indexToDelete = ...`)
    * **Action**: Click "Delete" on a row, then click "Confirm Delete".
    * **‚ùì Question**: What is the `id` of the entry being deleted? What do you expect `indexToDelete` to be?
    * **üí° Concept**: A multi-step UI action triggering a data-modifying function.

29. **Removing from the Array**
    * **File**: `app.js`, **Function**: `handleDeleteEntry`, **Line**: `180` (`carbonFootprintEntries.splice(indexToDelete, 1);`)
    * **Action**: Continue from #28.
    * **‚ùì Question**: Before this line, check the `length` of `carbonFootprintEntries`. Step over it. What is the `length` now?
    * **üí° Concept**: Using `splice()` to remove an element from an array by its index.

30. **Module Scope**
    * **File**: `calculator.js`, **Function**: `calculateFootprint`, **Line**: `127` (`const householdPoints = ...`)
    * **Action**: Submit a form.
    * **‚ùì Question**: Go to the **Console** and type `carbonFootprintEntries`. What is the result? Why can't this module access that array directly from `app.js`?
    * **üí° Concept**: **Module Scope**: Variables are private to their module unless explicitly exported.

31. **Asynchronous Timeout**
    * **File**: `app.js`, **Function**: `clearAllDataButton` event listener, **Line**: `260` (`resetClearAllButton();`)
    * **Action**: Click "Clear All Saved Data" *once* and wait 3 seconds without clicking again.
    * **‚ùì Question**: This code is inside a `setTimeout` callback. What action triggered it to run? How much time passed between the click and this code executing?
    * **üí° Concept**: Asynchronous JavaScript using `setTimeout` to delay an action.

32. **Global Event Listeners for UI State**
    * **File**: `app.js`, **Function**: `document` event listener, **Line**: `269` (`if(isConfirmingClearAll && event.target !== clearAllDataButton) {`)
    * **Action**: Click "Clear All Saved Data" once, then immediately click anywhere else on the page (e.g., the main heading).
    * **‚ùì Question**: Inspect `event.target`. What element did you click? Why is the `if` condition true, and why is this a good way to manage the button's confirmation state?
    * **üí° Concept**: Using a global event listener on `document` to reset UI state when a user clicks away from a specific element.