# 14.2  Geolocation and the Promise Constructor

## Update HTML and CSS
```html
<!-- Conceptual addition to index.html within <main class="container" after the "Calculate your carbon..." text> -->

    <!-- NEW SECTION FOR AQI DISPLAY -->
    <section id="aqi-display" class="aqi-card" style="display: none;">
        <h2 class="aqi-heading">Local Air Quality Index</h2>
        <p class="aqi-info-row">
            Current AQI: <span id="currentAqiValue" class="aqi-value">--</span> at
            <span id="aqiLocation" class="aqi-location">--</span> (<span id="aqiDate" class="aqi-date">--</span>)
        </p>
        <p class="note aqi-status" id="aqiStatusMessage"></p>
        <button id="refreshAqiButton" class="aqi-button">Refresh AQI</button>
    </section>
    <!-- END NEW SECTION -->

    <!-- ... rest of your index.html content (form, results, table) ... -->
```

```css
/* Create new file aqi-integrator.css and create link in html for this new css file*/

/* Styles for the main AQI display section */
.aqi-card {
    margin-top: 20px;
    padding: 20px;
    border: 1px solid #cceeff;
    border-radius: 8px;
    background-color: #e6f7ff;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); /* Optional: add a subtle shadow */
}

/* Styles for the heading within the AQI section */
.aqi-heading {
    color: #0056b3;
    margin-bottom: 15px;
    font-size: 1.6em; /* Adjust as needed */
}

/* Styles for the line displaying AQI value, location, and date */
.aqi-info-row {
    font-size: 1.1em;
    color: #333;
    margin-bottom: 10px;
}

/* Specific style for the AQI value itself */
.aqi-value {
    font-weight: bold;
    color: #007bff;
    font-size: 1.2em; /* Make the number stand out a bit more */
}

/* Style for the location text */
.aqi-location {
    font-style: italic;
    color: #555;
}

/* Style for the date text */
.aqi-date {
    font-size: 0.9em;
    color: #666;
}

/* Style for the status message (e.g., loading, error) */
.aqi-status {
    color: #cc0000; /* Red for errors, can be adjusted for loading */
    font-weight: bold;
    margin-top: 15px;
    min-height: 1.2em; /* Prevent layout shift if message appears */
}

/* Styles for the Refresh AQI Button */
.aqi-button {
    background-color: #007bff;
    color: white;
    padding: 10px 18px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 15px;
    font-size: 0.95em;
    transition: background-color 0.3s ease, transform 0.2s ease;
}

.aqi-button:hover {
    background-color: #0056b3;
    transform: translateY(-2px);
}

.aqi-button:active {
    background-color: #004085;
    transform: translateY(0);
}

/* Basic responsiveness for smaller screens, inheriting from overall style.css */
@media (max-width: 768px) {
    .aqi-card {
        padding: 15px;
    }
    .aqi-heading {
        font-size: 1.4em;
    }
    .aqi-info-row {
        font-size: 1em;
    }
    .aqi-value {
        font-size: 1.1em;
    }
    .aqi-button {
        padding: 8px 15px;
        font-size: 0.9em;
    }
}
```

1. ***14.2 Part 1: Create new files, hide API Key, handle imports and exports ***
* Create 3 new files `aqi-data-service.js`, `aqi-integrator.js` and `config.js`
    - Several files will be updated here.
        - API Key - KEEP private
            - Update the .gitignore
            // The following paths are ignored by one of your .gitignore files:
            // git-help/w14-1/config.js
            // hint: Use -f if you really want to add them.
            // hint: Turn this message off by running
            // hint: "git config advice.addIgnoredFile false"
        - // aqi-data-service.js
        - // RESPONSIBILITY: Handle all asynchronous network and location operations (Promises, fetch, API Key).
        - Export AQI_API_KEY 
            - // Should have been emailed to you
        - Export AQI_API_BASE_URL 'https://api.openweathermap.org/data/2.5/air_pollution';
        - Import config.js into `aqi-data-service.js`
        - getUserLocation
        - Import getUserLocation into `aqi-integrator.js`
        - // aqi-integrator.js
        - // RESPONSIBILITY: UI Orchestration, Error Handling, and Rendering.
        - //  --- The Main Orchestration Function ---
        - Setup and Export loadAndDisplayAqi
        - Import loadAndDisplayAqi into app.js call inside init
        - Test to make sure everything works together!
    - Before we start on Part 2
        * **Git Workflow (Save Progress):**
            * Commit your changes with the message: **"API files, function and setup done"**

1. ***14.2 Part 2: getUserLocation ***
* Code the function
    - `aqi-data-service.js`
        - // Gets the user's current geographical location (latitude and longitude).
        - // @returns {Promise<{latitude: number, longitude: number}>} A Promise that resolves
        - with coordinates or rejects with an Error if location cannot be obtained.
        